<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polymarket Trading Bot</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const PlayIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
        );

        const SquareIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="6" y="6" width="12" height="12"></rect>
            </svg>
        );

        const RefreshIcon = ({ spinning }) => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" style={{animation: spinning ? 'spin 1s linear infinite' : 'none'}}>
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        );

        const DollarIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );

        const ActivityIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
        );

        const SettingsIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6"></path>
            </svg>
        );

        const TrendingIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );

        const AlertIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const PolymarketBot = () => {
            const [markets, setMarkets] = useState([]);
            const [isRunning, setIsRunning] = useState(false);
            const [logs, setLogs] = useState([]);
            const [balance, setBalance] = useState(1000);
            const [positions, setPositions] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            const [useRealAPI, setUseRealAPI] = useState(false);
            
            const [config, setConfig] = useState({
                strategy: 'arbitrage',
                minProbDiff: 0.05,
                maxPositionSize: 100,
                checkInterval: 10000,
                timeframe: 'all'
            });

            const addLog = (message, type = 'info') => {
                const timestamp = new Date().toLocaleTimeString();
                setLogs(prev => [...prev, { timestamp, message, type }].slice(-100));
            };

            const determineTimeframe = (endDateISO) => {
                const now = Date.now();
                const endDate = new Date(endDateISO).getTime();
                const diff = endDate - now;
                
                const hour = 60 * 60 * 1000;
                const day = 24 * hour;
                const week = 7 * day;
                const month = 30 * day;
                
                if (diff < 2 * hour) return 'hourly';
                if (diff < 2 * day) return 'daily';
                if (diff < 2 * week) return 'weekly';
                if (diff < 2 * month) return 'monthly';
                if (diff < 6 * month) return 'quarterly';
                return 'yearly';
            };

            const fetchRealMarkets = async () => {
                setIsLoading(true);
                try {
                    addLog('ðŸ”„ Connecting to Polymarket API...', 'info');
                    
                    // Fetch markets with real data
                    const apiUrl = 'https://gamma-api.polymarket.com/markets?limit=100&active=true&closed=false';
                    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(apiUrl)}`;
                    
                    const response = await fetch(proxyUrl);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const result = await response.json();
                    
                    if (!result.contents) {
                        throw new Error('Invalid proxy response');
                    }
                    
                    const data = JSON.parse(result.contents);
                    
                    if (!Array.isArray(data) || data.length === 0) {
                        throw new Error('No markets in API response');
                    }
                    
                    addLog(`âœ“ API connected - fetching live prices...`, 'success');
                    
                    const marketList = [];
                    
                    // Parse markets and get REAL prices
                    for (const market of data) {
                        if (market.closed === false && market.active !== false) {
                            const outcomes = [];
                            
                            // Get REAL live prices from the market data
                            if (market.outcomes && Array.isArray(market.outcomes)) {
                                for (let idx = 0; idx < market.outcomes.length; idx++) {
                                    const outcome = market.outcomes[idx];
                                    let price = 0.5; // Default fallback
                                    
                                    // Try multiple price fields (Polymarket API structure)
                                    if (market.outcomePrices && market.outcomePrices.length > idx) {
                                        const priceStr = market.outcomePrices[idx];
                                        price = parseFloat(priceStr);
                                    } else if (market.clobTokenIds && market.clobTokenIds.length > idx) {
                                        // Try to fetch from last trade price or best bid/ask
                                        if (market.lastTradePrice) {
                                            price = parseFloat(market.lastTradePrice);
                                        } else if (market.bestBid && market.bestAsk) {
                                            // Use midpoint of bid/ask spread
                                            price = (parseFloat(market.bestBid) + parseFloat(market.bestAsk)) / 2;
                                        }
                                    }
                                    
                                    // Validate price is reasonable
                                    if (isNaN(price) || price < 0 || price > 1) {
                                        price = 0.5;
                                    }
                                    
                                    outcomes.push({
                                        name: outcome,
                                        price: price
                                    });
                                }
                            }
                            
                            // Ensure we have at least 2 outcomes
                            if (outcomes.length === 0) {
                                outcomes.push(
                                    { name: 'Yes', price: 0.5 },
                                    { name: 'No', price: 0.5 }
                                );
                            } else if (outcomes.length === 1) {
                                outcomes.push({ name: 'No', price: 1 - outcomes[0].price });
                            }
                            
                            marketList.push({
                                id: market.condition_id || market.id || `market-${Date.now()}`,
                                question: market.question || market.description || 'Unknown Market',
                                outcomes: outcomes,
                                volume: parseFloat(market.volume) || 0,
                                liquidity: parseFloat(market.liquidity) || 0,
                                endDate: market.end_date_iso ? new Date(market.end_date_iso).getTime() : Date.now() + 86400000,
                                timeframe: market.end_date_iso ? determineTimeframe(market.end_date_iso) : 'daily',
                                category: market.category || market.groupItemTitle || 'General',
                                // Store token IDs for potential future price updates
                                tokenIds: market.clobTokenIds || []
                            });
                        }
                        
                        // Limit to prevent too many markets
                        if (marketList.length >= 50) break;
                    }
                    
                    if (marketList.length === 0) {
                        throw new Error('No active markets found after filtering');
                    }
                    
                    setMarkets(marketList);
                    addLog(`âœ… Loaded ${marketList.length} live markets with REAL prices`, 'success');
                    addLog(`ðŸ’° Trading with simulated money on real data`, 'info');
                    return marketList;
                    
                } catch (error) {
                    addLog(`âŒ Failed: ${error.message}`, 'error');
                    addLog(`ðŸ”§ This might be due to:`, 'info');
                    addLog(`   â€¢ CORS restrictions (deploy to fix)`, 'info');
                    addLog(`   â€¢ Network/firewall blocking API`, 'info');
                    addLog(`   â€¢ Polymarket API temporarily down`, 'info');
                    addLog(`ðŸ’¡ Using demo markets for now`, 'warning');
                    return null;
                } finally {
                    setIsLoading(false);
                }
            };

            const createDemoMarkets = () => {
                const now = Date.now();
                const hour = 60 * 60 * 1000;
                const day = 24 * hour;
                
                const demoMarkets = [
                    // HOURLY MARKETS (Ultra short-term)
                    {
                        id: 'demo-h1',
                        question: 'Will BTC price increase in the next hour?',
                        outcomes: [{ name: 'Yes', price: 0.49 }, { name: 'No', price: 0.52 }],
                        volume: 45000,
                        endDate: now + 55 * 60 * 1000,
                        timeframe: 'hourly',
                        category: 'Crypto'
                    },
                    {
                        id: 'demo-h2',
                        question: 'Will ETH/BTC ratio go up in next 2 hours?',
                        outcomes: [{ name: 'Yes', price: 0.47 }, { name: 'No', price: 0.54 }],
                        volume: 38000,
                        endDate: now + 2 * hour,
                        timeframe: 'hourly',
                        category: 'Crypto'
                    },
                    {
                        id: 'demo-h3',
                        question: 'Will SPY go green in next hour?',
                        outcomes: [{ name: 'Yes', price: 0.51 }, { name: 'No', price: 0.50 }],
                        volume: 62000,
                        endDate: now + hour,
                        timeframe: 'hourly',
                        category: 'Finance'
                    },
                    
                    // DAILY MARKETS
                    {
                        id: 'demo-d1',
                        question: 'Will Bitcoin go up today?',
                        outcomes: [{ name: 'Yes', price: 0.51 }, { name: 'No', price: 0.50 }],
                        volume: 150000,
                        endDate: now + 18 * hour,
                        timeframe: 'daily',
                        category: 'Crypto'
                    },
                    {
                        id: 'demo-d2',
                        question: 'Will Ethereum outperform Bitcoin today?',
                        outcomes: [{ name: 'Yes', price: 0.46 }, { name: 'No', price: 0.55 }],
                        volume: 95000,
                        endDate: now + 20 * hour,
                        timeframe: 'daily',
                        category: 'Crypto'
                    },
                    {
                        id: 'demo-d3',
                        question: 'Will tech stocks rally today?',
                        outcomes: [{ name: 'Yes', price: 0.54 }, { name: 'No', price: 0.47 }],
                        volume: 110000,
                        endDate: now + 16 * hour,
                        timeframe: 'daily',
                        category: 'Finance'
                    },
                    {
                        id: 'demo-d4',
                        question: 'Will NVDA hit new ATH today?',
                        outcomes: [{ name: 'Yes', price: 0.28 }, { name: 'No', price: 0.73 }],
                        volume: 180000,
                        endDate: now + 14 * hour,
                        timeframe: 'daily',
                        category: 'Finance'
                    },
                    {
                        id: 'demo-d5',
                        question: 'Will USD/EUR close higher today?',
                        outcomes: [{ name: 'Yes', price: 0.52 }, { name: 'No', price: 0.49 }],
                        volume: 72000,
                        endDate: now + 22 * hour,
                        timeframe: 'daily',
                        category: 'Finance'
                    },
                    {
                        id: 'demo-d6',
                        question: 'Will gold price increase today?',
                        outcomes: [{ name: 'Yes', price: 0.48 }, { name: 'No', price: 0.53 }],
                        volume: 88000,
                        endDate: now + 19 * hour,
                        timeframe: 'daily',
                        category: 'Commodities'
                    },
                    
                    // WEEKLY MARKETS
                    {
                        id: 'demo-w1',
                        question: 'Will Bitcoin close above $95k this week?',
                        outcomes: [{ name: 'Yes', price: 0.48 }, { name: 'No', price: 0.53 }],
                        volume: 320000,
                        endDate: now + 5 * day,
                        timeframe: 'weekly',
                        category: 'Crypto'
                    },
                    {
                        id: 'demo-w2',
                        question: 'Will Nvidia stock hit new ATH this week?',
                        outcomes: [{ name: 'Yes', price: 0.41 }, { name: 'No', price: 0.60 }],
                        volume: 280000,
                        endDate: now + 4 * day,
                        timeframe: 'weekly',
                        category: 'Finance'
                    },
                    {
                        id: 'demo-w3',
                        question: 'Will there be a major AI announcement this week?',
                        outcomes: [{ name: 'Yes', price: 0.52 }, { name: 'No', price: 0.49 }],
                        volume: 190000,
                        endDate: now + 6 * day,
                        timeframe: 'weekly',
                        category: 'Technology'
                    },
                    {
                        id: 'demo-w4',
                        question: 'Will Tesla deliver 500k+ vehicles this quarter?',
                        outcomes: [{ name: 'Yes', price: 0.67 }, { name: 'No', price: 0.34 }],
                        volume: 420000,
                        endDate: now + 5 * day,
                        timeframe: 'weekly',
                        category: 'Business'
                    },
                    {
                        id: 'demo-w5',
                        question: 'Will S&P 500 gain 2%+ this week?',
                        outcomes: [{ name: 'Yes', price: 0.35 }, { name: 'No', price: 0.66 }],
                        volume: 510000,
                        endDate: now + 3 * day,
                        timeframe: 'weekly',
                        category: 'Finance'
                    },
                    {
                        id: 'demo-w6',
                        question: 'Will oil prices exceed $85/barrel this week?',
                        outcomes: [{ name: 'Yes', price: 0.43 }, { name: 'No', price: 0.58 }],
                        volume: 145000,
                        endDate: now + 6 * day,
                        timeframe: 'weekly',
                        category: 'Commodities'
                    },
                    
                    // MONTHLY MARKETS
                    {
                        id: 'demo-m1',
                        question: 'Will S&P 500 close above 6000 by end of January 2026?',
                        outcomes: [{ name: 'Yes', price: 0.58 }, { name: 'No', price: 0.43 }],
                        volume: 450000,
                        endDate: now + 15 * day,
                        timeframe: 'monthly',
                        category: 'Finance'
                    },
                    {
                        id: 'demo-m2',
                        question: 'Will Fed cut rates in February 2026?',
                        outcomes: [{ name: 'Yes', price: 0.37 }, { name: 'No', price: 0.64 }],
                        volume: 780000,
                        endDate: now + 45 * day,
                        timeframe: 'monthly',
                        category: 'Economics'
                    },
                    {
                        id: 'demo-m3',
                        question: 'Will inflation rate drop below 2.5% this month?',
                        outcomes: [{ name: 'Yes', price: 0.44 }, { name: 'No', price: 0.57 }],
                        volume: 320000,
                        endDate: now + 28 * day,
                        timeframe: 'monthly',
                        category: 'Economics'
                    },
                    {
                        id: 'demo-m4',
                        question: 'Will Apple announce new product this month?',
                        outcomes: [{ name: 'Yes', price: 0.29 }, { name: 'No', price: 0.72 }],
                        volume: 210000,
                        endDate: now + 25 * day,
                        timeframe: 'monthly',
                        category: 'Technology'
                    },
                    {
                        id: 'demo-m5',
                        question: 'Will unemployment rate stay below 4% this month?',
                        outcomes: [{ name: 'Yes', price: 0.71 }, { name: 'No', price: 0.30 }],
                        volume: 280000,
                        endDate: now + 20 * day,
                        timeframe: 'monthly',
                        category: 'Economics'
                    },
                    {
                        id: 'demo-m6',
                        question: 'Will Bitcoin volatility exceed 50% this month?',
                        outcomes: [{ name: 'Yes', price: 0.38 }, { name: 'No', price: 0.63 }],
                        volume: 195000,
                        endDate: now + 22 * day,
                        timeframe: 'monthly',
                        category: 'Crypto'
                    },
                    
                    // QUARTERLY MARKETS
                    {
                        id: 'demo-q1',
                        question: 'Will Ethereum ETF trading volume exceed $1B daily by Q2 2026?',
                        outcomes: [{ name: 'Yes', price: 0.55 }, { name: 'No', price: 0.46 }],
                        volume: 760000,
                        endDate: now + 90 * day,
                        timeframe: 'quarterly',
                        category: 'Crypto'
                    },
                    {
                        id: 'demo-q2',
                        question: 'Will US GDP growth exceed 3% in Q1 2026?',
                        outcomes: [{ name: 'Yes', price: 0.42 }, { name: 'No', price: 0.59 }],
                        volume: 540000,
                        endDate: now + 75 * day,
                        timeframe: 'quarterly',
                        category: 'Economics'
                    },
                    {
                        id: 'demo-q3',
                        question: 'Will OpenAI release GPT-5 by Q2 2026?',
                        outcomes: [{ name: 'Yes', price: 0.33 }, { name: 'No', price: 0.68 }],
                        volume: 890000,
                        endDate: now + 120 * day,
                        timeframe: 'quarterly',
                        category: 'Technology'
                    },
                    {
                        id: 'demo-q4',
                        question: 'Will Tesla stock exceed $300 by Q2 2026?',
                        outcomes: [{ name: 'Yes', price: 0.48 }, { name: 'No', price: 0.53 }],
                        volume: 670000,
                        endDate: now + 100 * day,
                        timeframe: 'quarterly',
                        category: 'Finance'
                    },
                    
                    // YEARLY MARKETS (Long-term)
                    {
                        id: 'demo-y1',
                        question: 'Will Bitcoin reach $100k by end of 2026?',
                        outcomes: [{ name: 'Yes', price: 0.65 }, { name: 'No', price: 0.36 }],
                        volume: 1250000,
                        endDate: now + 365 * day,
                        timeframe: 'yearly',
                        category: 'Crypto'
                    },
                    {
                        id: 'demo-y2',
                        question: 'Will AI surpass human performance in coding by 2027?',
                        outcomes: [{ name: 'Yes', price: 0.42 }, { name: 'No', price: 0.59 }],
                        volume: 890000,
                        endDate: now + 400 * day,
                        timeframe: 'yearly',
                        category: 'Technology'
                    },
                    {
                        id: 'demo-y3',
                        question: 'Will there be a recession in 2026?',
                        outcomes: [{ name: 'Yes', price: 0.31 }, { name: 'No', price: 0.70 }],
                        volume: 2100000,
                        endDate: now + 350 * day,
                        timeframe: 'yearly',
                        category: 'Economics'
                    },
                    {
                        id: 'demo-y4',
                        question: 'Will SpaceX land humans on Mars before 2030?',
                        outcomes: [{ name: 'Yes', price: 0.28 }, { name: 'No', price: 0.73 }],
                        volume: 1450000,
                        endDate: now + 1400 * day,
                        timeframe: 'yearly',
                        category: 'Space'
                    },
                    {
                        id: 'demo-y5',
                        question: 'Will quantum computer break RSA-2048 by 2028?',
                        outcomes: [{ name: 'Yes', price: 0.19 }, { name: 'No', price: 0.82 }],
                        volume: 620000,
                        endDate: now + 730 * day,
                        timeframe: 'yearly',
                        category: 'Technology'
                    },
                    {
                        id: 'demo-y6',
                        question: 'Will global temperatures exceed 1.5Â°C warming by end of 2026?',
                        outcomes: [{ name: 'Yes', price: 0.68 }, { name: 'No', price: 0.33 }],
                        volume: 980000,
                        endDate: now + 350 * day,
                        timeframe: 'yearly',
                        category: 'Climate'
                    },
                    {
                        id: 'demo-y7',
                        question: 'Will Apple release AR headset under $1000 in 2026?',
                        outcomes: [{ name: 'Yes', price: 0.44 }, { name: 'No', price: 0.57 }],
                        volume: 1120000,
                        endDate: now + 200 * day,
                        timeframe: 'yearly',
                        category: 'Technology'
                    },
                    {
                        id: 'demo-y8',
                        question: 'Will US have presidential election controversy in 2026?',
                        outcomes: [{ name: 'Yes', price: 0.37 }, { name: 'No', price: 0.64 }],
                        volume: 1850000,
                        endDate: now + 320 * day,
                        timeframe: 'yearly',
                        category: 'Politics'
                    },
                    {
                        id: 'demo-y9',
                        question: 'Will Meta release consumer VR headset under $300 in 2026?',
                        outcomes: [{ name: 'Yes', price: 0.51 }, { name: 'No', price: 0.50 }],
                        volume: 720000,
                        endDate: now + 280 * day,
                        timeframe: 'yearly',
                        category: 'Technology'
                    },
                    {
                        id: 'demo-y10',
                        question: 'Will renewable energy exceed 50% of US grid by 2027?',
                        outcomes: [{ name: 'Yes', price: 0.35 }, { name: 'No', price: 0.66 }],
                        volume: 580000,
                        endDate: now + 500 * day,
                        timeframe: 'yearly',
                        category: 'Climate'
                    }
                ];
                
                setMarkets(demoMarkets);
                addLog(`ðŸ“Š Loaded ${demoMarkets.length} demo markets across all timeframes`, 'info');
            };

            useEffect(() => {
                const initMarkets = async () => {
                    if (useRealAPI) {
                        const realMarkets = await fetchRealMarkets();
                        if (!realMarkets) createDemoMarkets();
                    } else {
                        createDemoMarkets();
                    }
                };
                initMarkets();
            }, [useRealAPI]);

            const filteredMarkets = markets.filter(market => {
                if (config.timeframe === 'all') return true;
                return market.timeframe === config.timeframe;
            });

            const getTimeRemaining = (endDate) => {
                const remaining = endDate - Date.now();
                const hours = Math.floor(remaining / (1000 * 60 * 60));
                const days = Math.floor(hours / 24);
                
                if (days > 30) return `${Math.floor(days / 30)}mo`;
                if (days > 0) return `${days}d`;
                if (hours > 0) return `${hours}h`;
                return '<1h';
            };

            const analyzeMarket = (market) => {
                if (!market.outcomes || market.outcomes.length < 2) return null;
                
                const yesPrice = parseFloat(market.outcomes[0]?.price || 0);
                const noPrice = parseFloat(market.outcomes[1]?.price || 0);
                const totalProb = yesPrice + noPrice;
                
                if (Math.abs(totalProb - 1) > config.minProbDiff) {
                    return {
                        type: 'arbitrage',
                        market: market.question,
                        recommendation: totalProb > 1 ? 'SELL BOTH' : 'BUY BOTH',
                        expectedReturn: (Math.abs(totalProb - 1) * 100).toFixed(1),
                        yesPrice
                    };
                }
                
                if (yesPrice < 0.3 || yesPrice > 0.7) {
                    return {
                        type: 'value',
                        market: market.question,
                        recommendation: yesPrice < 0.3 ? 'BUY YES' : 'BUY NO',
                        expectedReturn: (Math.abs(0.5 - yesPrice) * 100).toFixed(1),
                        yesPrice
                    };
                }
                
                return null;
            };

            const executeTrade = (signal) => {
                const tradeSize = Math.min(config.maxPositionSize, balance * 0.1);
                
                if (tradeSize > balance) {
                    addLog('âŒ Insufficient balance', 'error');
                    return;
                }

                setBalance(prev => prev - tradeSize);
                setPositions(prev => [...prev, {
                    id: Date.now(),
                    market: signal.market,
                    type: signal.recommendation,
                    size: tradeSize,
                    entry: Date.now(),
                    expectedReturn: signal.expectedReturn
                }]);
                
                addLog(`âœ“ TRADE: ${signal.recommendation} - "${signal.market.substring(0, 35)}..." ($${tradeSize.toFixed(2)})`, 'success');
            };

            useEffect(() => {
                if (!isRunning) return;

                const interval = setInterval(async () => {
                    addLog('ðŸ” Scanning...', 'info');
                    
                    if (useRealAPI) await fetchRealMarkets();
                    
                    let found = 0;
                    for (const market of filteredMarkets) {
                        const signal = analyzeMarket(market);
                        if (signal && balance >= 10) {
                            found++;
                            addLog(`ðŸŽ¯ ${signal.type.toUpperCase()} found!`, 'warning');
                            executeTrade(signal);
                        }
                    }
                    
                    if (found === 0) addLog('No opportunities', 'info');
                }, config.checkInterval);

                return () => clearInterval(interval);
            }, [isRunning, filteredMarkets, config, balance, useRealAPI]);

            const toggleBot = () => {
                if (!isRunning) {
                    addLog('ðŸ¤– Bot started', 'success');
                } else {
                    addLog('â¸ï¸ Bot stopped', 'warning');
                }
                setIsRunning(!isRunning);
            };

            const refreshMarkets = async () => {
                if (useRealAPI) {
                    await fetchRealMarkets();
                } else {
                    createDemoMarkets();
                }
            };

            const closePosition = (posId) => {
                const position = positions.find(p => p.id === posId);
                if (position) {
                    const profit = position.size * (Math.random() * 0.2 - 0.05);
                    setBalance(prev => prev + position.size + profit);
                    setPositions(prev => prev.filter(p => p.id !== posId));
                    addLog(`Closed: ${profit >= 0 ? '+' : ''}$${profit.toFixed(2)}`, profit >= 0 ? 'success' : 'error');
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-slate-800/50 backdrop-blur-sm rounded-lg p-6 mb-6 border border-purple-500/20">
                            <div className="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-white mb-2">Polymarket Trading Bot</h1>
                                    <p className="text-gray-400">{useRealAPI ? 'ðŸ”´ Live Mode' : 'ðŸ“Š Demo Mode'}</p>
                                </div>
                                <div className="flex gap-4">
                                    <div className="bg-green-500/20 rounded-lg p-4 border border-green-500/30">
                                        <div className="flex items-center gap-2 text-green-400 mb-1">
                                            <DollarIcon />
                                            <span className="text-sm">Balance</span>
                                        </div>
                                        <div className="text-2xl font-bold text-white">${balance.toFixed(2)}</div>
                                    </div>
                                    <div className="bg-blue-500/20 rounded-lg p-4 border border-blue-500/30">
                                        <div className="flex items-center gap-2 text-blue-400 mb-1">
                                            <ActivityIcon />
                                            <span className="text-sm">Positions</span>
                                        </div>
                                        <div className="text-2xl font-bold text-white">{positions.length}</div>
                                    </div>
                                </div>
                            </div>

                            <div className="flex items-center gap-3 p-4 bg-slate-900/50 rounded-lg border border-yellow-500/20">
                                <AlertIcon />
                                <label className="flex items-center gap-3 cursor-pointer flex-1">
                                    <input type="checkbox" checked={useRealAPI} onChange={(e) => setUseRealAPI(e.target.checked)} className="w-5 h-5" />
                                    <div>
                                        <span className="text-white font-medium">Use Real Polymarket API</span>
                                        <p className="text-gray-400 text-sm">Fetch live data (trades simulated)</p>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div className="lg:col-span-1 space-y-6">
                                <div className="bg-slate-800/50 backdrop-blur-sm rounded-lg p-6 border border-purple-500/20">
                                    <div className="flex items-center gap-2 mb-4">
                                        <SettingsIcon />
                                        <h2 className="text-xl font-bold text-white">Controls</h2>
                                    </div>
                                    
                                    <div className="space-y-3">
                                        <button onClick={toggleBot} className={`w-full py-3 rounded-lg font-semibold flex items-center justify-center gap-2 ${isRunning ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'} text-white`}>
                                            {isRunning ? <SquareIcon /> : <PlayIcon />}
                                            {isRunning ? 'Stop Bot' : 'Start Bot'}
                                        </button>
                                        <button onClick={refreshMarkets} disabled={isLoading} className="w-full py-2 rounded-lg font-semibold flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-white">
                                            <RefreshIcon spinning={isLoading} />
                                            Refresh
                                        </button>
                                    </div>

                                    <div className="mt-6 space-y-4">
                                        <div>
                                            <label className="text-gray-400 text-sm mb-2 block">Timeframe</label>
                                            <select value={config.timeframe} onChange={(e) => setConfig({...config, timeframe: e.target.value})} className="w-full bg-slate-700 text-white rounded p-2">
                                                <option value="all">All</option>
                                                <option value="hourly">Hourly</option>
                                                <option value="daily">Daily</option>
                                                <option value="weekly">Weekly</option>
                                                <option value="monthly">Monthly</option>
                                                <option value="yearly">Yearly</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="text-gray-400 text-sm mb-2 block">Min Diff: {(config.minProbDiff * 100).toFixed(0)}%</label>
                                            <input type="range" min="0.01" max="0.2" step="0.01" value={config.minProbDiff} onChange={(e) => setConfig({...config, minProbDiff: parseFloat(e.target.value)})} className="w-full" />
                                        </div>
                                        <div>
                                            <label className="text-gray-400 text-sm mb-2 block">Max Position: ${config.maxPositionSize}</label>
                                            <input type="range" min="10" max="500" step="10" value={config.maxPositionSize} onChange={(e) => setConfig({...config, maxPositionSize: parseInt(e.target.value)})} className="w-full" />
                                        </div>
                                        <div>
                                            <label className="text-gray-400 text-sm mb-2 block">Interval: {config.checkInterval/1000}s</label>
                                            <input type="range" min="5000" max="60000" step="5000" value={config.checkInterval} onChange={(e) => setConfig({...config, checkInterval: parseInt(e.target.value)})} className="w-full" />
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-slate-800/50 backdrop-blur-sm rounded-lg p-6 border border-purple-500/20">
                                    <div className="flex items-center justify-between mb-4">
                                        <div className="flex items-center gap-2">
                                            <TrendingIcon />
                                            <h2 className="text-xl font-bold text-white">Markets</h2>
                                        </div>
                                        <span className="text-sm text-gray-400">{filteredMarkets.length}</span>
                                    </div>
                                    
                                    <div className="space-y-2 max-h-96 overflow-y-auto">
                                        {filteredMarkets.map(m => (
                                            <div key={m.id} className="bg-slate-700/50 rounded p-3 hover:bg-slate-700">
                                                <div className="flex justify-between mb-2">
                                                    <div className="text-white text-sm font-medium flex-1">{m.question}</div>
                                                    <span className="text-xs bg-purple-500/20 text-purple-300 px-2 py-1 rounded ml-2">{getTimeRemaining(m.endDate)}</span>
                                                </div>
                                                <div className="flex gap-2 text-xs">
                                                    <span className="text-green-400">Yes: {(m.outcomes[0]?.price * 100).toFixed(0)}%</span>
                                                    <span className="text-red-400">No: {(m.outcomes[1]?.price * 100).toFixed(0)}%</span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            <div className="lg:col-span-2 space-y-6">
                                <div className="bg-slate-800/50 backdrop-blur-sm rounded-lg p-6 border border-purple-500/20">
                                    <h2 className="text-xl font-bold text-white mb-4">Activity Log</h2>
                                    <div className="bg-slate-900 rounded p-4 h-64 overflow-y-auto font-mono text-sm">
                                        {logs.length === 0 ? (
                                            <div className="text-gray-500">Start bot to begin</div>
                                        ) : (
                                            logs.slice().reverse().map((log, i) => (
                                                <div key={i} className="mb-2">
                                                    <span className="text-gray-500">[{log.timestamp}]</span>
                                                    <span className={`ml-2 ${log.type === 'error' ? 'text-red-400' : log.type === 'success' ? 'text-green-400' : log.type === 'warning' ? 'text-yellow-400' : 'text-gray-300'}`}>{log.message}</span>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>

                                <div className="bg-slate-800/50 backdrop-blur-sm rounded-lg p-6 border border-purple-500/20">
                                    <h2 className="text-xl font-bold text-white mb-4">Positions</h2>
                                    {positions.length === 0 ? (
                                        <div className="text-gray-500 text-center py-8">No positions</div>
                                    ) : (
                                        <div className="space-y-3">
                                            {positions.map(pos => (
                                                <div key={pos.id} className="bg-slate-700/50 rounded p-4">
                                                    <div className="flex justify-between mb-2">
                                                        <div className="text-white font-medium flex-1 text-sm">{pos.market}</div>
                                                        <button onClick={() => closePosition(pos.id)} className="px-3 py-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded text-xs">Close</button>
                                                    </div>
                                                    <div className="flex justify-between text-sm">
                                                        <span className="text-purple-400">{pos.type}</span>
                                                        <span className="text-green-400">${pos.size.toFixed(2)}</span>
                                                    </div>
                                                    <div className="text-xs text-gray-500 mt-1">+{pos.expectedReturn}% exp</div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<PolymarketBot />, document.getElementById('root'));
    </script>
    <style>
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</body>
</html>
